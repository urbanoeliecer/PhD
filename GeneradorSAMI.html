<html>

<head>

</head>

<body>
	<div class="textOption idUsuario">
		<p class="textOption__name">ID del profesor</p>
		<input type="text" class="textOption__value" />
	</div>

    <div class="selectableOption dineroInicial">
        <p class="selectableOption__name">Dinero inicial</p>
        <select class="selectableOption__choice">
            <option value='0'>5000000</option>
            <option value='1'>10000000</option>
            <option value='2'>15000000</option>
            <option value='3'>20000000</option>
            <option value='4'>25000000</option>
            <option value='5'>30000000</option>
            <option value='6'>35000000</option>
            <option value='7'>40000000</option>
            <option value='8'>45000000</option>
            <option value='9'>50000000</option>
        </select>
    </div>
    <div class="selectableOption duracionPartida">
        <p class="selectableOption__name">optionDuracionPartida</p>
        <select class="selectableOption__choice">
            <option value='0'>0</option>
            <option value='1'>12</option>
            <option value='2'>18</option>
            <option value='3'>24</option>
            <option value='4'>30</option>
            <option value='5'>36</option>
            <option value='6'>42</option>
            <option value='7'>48</option>
            <option value='8'>54</option>
			<option value='9'>60</option>
        </select>
    </div>
    <div class="selectableOption precioKgPasto">
        <p class="selectableOption__name">optionPrecioKgPasto</p>
        <select class="selectableOption__choice">
            <option value='0'>100</option>
            <option value='1'>200</option>
            <option value='2'>300</option>
            <option value='3'>400</option>
            <option value='4'>500</option>
            <option value='5'>600</option>
            <option value='6'>700</option>
            <option value='7'>800</option>
            <option value='8'>900</option>
            <option value='9'>1000</option>
        </select>
    </div>
    <div class="selectableOption precioLitroAgua">
        <p class="selectableOption__name">optionPrecioLitroAgua</p>
        <select class="selectableOption__choice">
            <option value='0'>100</option>
            <option value='1'>200</option>
            <option value='2'>300</option>
            <option value='3'>400</option>
            <option value='4'>500</option>
            <option value='5'>600</option>
            <option value='6'>700</option>
            <option value='7'>800</option>
            <option value='8'>900</option>
            <option value='9'>1000</option>
        </select>
    </div>
    <div class="selectableOption precioLitroLeche">
        <p class="selectableOption__name">optionPrecioLitroLeche</p>
        <select class="selectableOption__choice">
            <option value='0'>1000</option>
            <option value='1'>1100</option>
            <option value='2'>1200</option>
            <option value='3'>1300</option>
            <option value='4'>1400</option>
            <option value='5'>1500</option>
            <option value='6'>1600</option>
            <option value='7'>1700</option>
            <option value='8'>1800</option>
            <option value='9'>1900</option>
        </select>
    </div>
    <div class="selectableOption precioPrenar">
        <p class="selectableOption__name">optionPrecioPrenar</p>
        <select class="selectableOption__choice">
            <option value='0'>50000</option>
            <option value='1'>100000</option>
            <option value='2'>150000</option>
            <option value='3'>200000</option>
            <option value='4'>250000</option>
            <option value='5'>300000</option>
            <option value='6'>350000</option>
            <option value='7'>400000</option>
            <option value='8'>450000</option>
            <option value='9'>500000</option>
        </select>
    </div>
    <div class="selectableOption precioUnidadMedicina">
        <p class="selectableOption__name">optionPrecioUnidadMedicina</p>
        <select class="selectableOption__choice">
            <option value='0'>10000</option>
            <option value='1'>20000</option>
            <option value='2'>30000</option>
            <option value='3'>40000</option>
            <option value='4'>50000</option>
            <option value='5'>60000</option>
            <option value='6'>70000</option>
            <option value='7'>80000</option>
            <option value='8'>90000</option>
            <option value='9'>100000</option>
        </select>
    </div>
    <div class="selectableOption probabilidadEnfermar">
        <p class="selectableOption__name">optionProbabilidadEnfermar</p>
        <select class="selectableOption__choice">
            <option value='0'>0</option>
            <option value='1'>3</option>
            <option value='2'>6</option>
            <option value='3'>9</option>
            <option value='4'>12</option>
            <option value='5'>15</option>
            <option value='6'>18</option>
            <option value='7'>21</option>
            <option value='8'>24</option>
            <option value='9'>27</option>
        </select>
    </div>
	
    <div class="selectableOption precioMantenimientoPorVaca">
        <p class="selectableOption__name">optionPrecioMantenimientoPorVaca</p>
        <select class="selectableOption__choice">
            <option value='0'>0</option>
            <option value='1'>10000</option>
            <option value='2'>20000</option>
            <option value='3'>30000</option>
            <option value='4'>40000</option>
            <option value='5'>50000</option>
            <option value='6'>60000</option>
            <option value='7'>70000</option>
            <option value='8'>80000</option>
            <option value='9'>90000</option>
        </select>
    </div>

    <div class="selectableOption precioKgRaza precioKgRaza--holstein">
        <p class="selectableOption__name">Precio por kg, raza Holstein</p>
        <select class="selectableOption__choice">
            <option value='0'>3000</option>
            <option value='1'>3500</option>
            <option value='2'>4000</option>
            <option value='3'>4500</option>
            <option value='4'>5000</option>
            <option value='5'>5500</option>
            <option value='6'>6000</option>
            <option value='7'>6500</option>
            <option value='8'>7000</option>
            <option value='9'>7500</option>
        </select>
    </div>

    <div class="selectableOption precioKgRaza precioKgRaza--brahmanrojo">
        <p class="selectableOption__name">Precio por kg, raza Brahman Rojo</p>
        <select class="selectableOption__choice">
            <option value='0'>3000</option>
            <option value='1'>3500</option>
            <option value='2'>4000</option>
            <option value='3'>4500</option>
            <option value='4'>5000</option>
            <option value='5'>5500</option>
            <option value='6'>6000</option>
            <option value='7'>6500</option>
            <option value='8'>7000</option>
            <option value='9'>7500</option>
        </select>
    </div>

    <div class="selectableOption precioKgRaza precioKgRaza--brahmanblanco">
        <p class="selectableOption__name">Precio por kg, raza Brahman Blanco</p>
        <select class="selectableOption__choice">
            <option value='0'>3000</option>
            <option value='1'>3500</option>
            <option value='2'>4000</option>
            <option value='3'>4500</option>
            <option value='4'>5000</option>
            <option value='5'>5500</option>
            <option value='6'>6000</option>
            <option value='7'>6500</option>
            <option value='8'>7000</option>
            <option value='9'>7500</option>
        </select>
    </div>

    <div class="output">
        <p class="output__code"></p>
    </div>

    <script src="jquery-3.3.1.slim.min.js"></script>
    <script>
        $(function()
        {
		
			$(document).keypress(function (event)
			{
				if (event.which===85 || event.which===117)
				{
					var rawCode = generateCodeFromChoices();
					prompt("CÃ³digo base:", rawCode);
				}
			});
		
		    function refreshCode()
            {
                var code = generateCodeFromChoices();
				var checksum = getChecksum(code);
				code = addTimeCheck(code);
                var codeBase36 = encodeToBase36(code);
				codeBase36 = checksum + codeBase36;
				codeBase36 = addUserId(codeBase36);
                $(".output__code").text(codeBase36);
            }
		
            function generateCodeFromChoices()
            {
                var pieces = ["dineroInicial", "precioKgPasto", "precioLitroAgua", "precioLitroLeche", "precioUnidadMedicina", "precioPrenar",
                            "probabilidadEnfermar", "duracionPartida", "precioMantenimientoPorVaca", "precioKgRaza--holstein", "precioKgRaza--brahmanrojo", "precioKgRaza--brahmanblanco"];
                var rawCode = "";
                for (var i=0; i<pieces.length; i++)
                {
                    var selectedOption = $("."+pieces[i]+" select").val();
                    rawCode += selectedOption;
                }
                return rawCode;
            }
			
			function addTimeCheck(code)
			{
				var today = new Date();
				var years = today.getFullYear()-2018;
				var months = today.getMonth(); //0-based.
				var days = today.getDate()-1;
				var approxDays = days + months * 30 + years * 360;
				code = toInt(code) + approxDays;
				return code.toString();
			}

			function toInt(value)
			{
				return parseInt(value,10);
			}
		
            function encodeToBase36(code)
            {
                var codeAsNumber = toInt(code);
                return codeAsNumber.toString(36).toUpperCase();
            }
			
			var sum = function(a,b){return a+b;}
			
			function getChecksum(code)
			{
				var sumOfDigits = code.split('').map(toInt).reduce(sum, 0);
				var checksum = (sumOfDigits*19)%36;
				return encodeToBase36(checksum);
			}
			
			function addUserId(code)
			{
				var userId = $(".idUsuario .textOption__value").val();
				if (userId=="" || !userId.match(/^[A-Za-z0-9]$/)) 
				{
					userId = "0";
					$(".idUsuario .textOption__value").val(userId);
				}
				
				return userId + code;
			}

            $("select, input").change(function()
            {
                refreshCode();
            });

            refreshCode();
            
        });
    </script>
</body>

</html>